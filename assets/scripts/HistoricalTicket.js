import{deleteCard as t}from"./storage.js";import{toggleClassToArr as e,convertArrToReadableString as a}from"./util.js";const o=document.getElementById("historical-ticket-template");class s extends HTMLElement{constructor(){super(),this.flipped=!1,this.animations=!1,this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(o.content.cloneNode(!0)),this.dom=this.fetchElementsFromDOM(),this.dom.backContent.addEventListener("click",this.flipCard.bind(this)),this.dom.flipButton.addEventListener("click",this.flipCard.bind(this)),this.dom.discardButton.addEventListener("click",()=>{t(this)})}set content(t){var e,o,s,i;t&&(o=a(t.currentNumbers),e=document.createTextNode(t.currentMessage),o=document.createTextNode(o),s=this.shadowRoot.querySelector('slot[name="fortune-content"]'),i=this.shadowRoot.querySelector('slot[name="lucky-numbers"]'),s.replaceChildren(e),i.replaceChildren(o),this.dom.headerImage.src=`assets/images/image-bank-front/header-${t.currentImageFront}.webp`,this.dom.backImage.src=`assets/images/image-bank-back/background-card-${t.currentImageBack}.webp`)}fetchElementsFromDOM(){return{headerImage:this.shadowRoot.querySelector(".ticket-header-image"),backImage:this.shadowRoot.querySelector(".ticket-back-image"),overlay:this.shadowRoot.querySelector(".ticket-flip-overlay"),backContent:this.shadowRoot.querySelector(".ticket-back-content"),frontContent:this.shadowRoot.querySelector(".ticket-front-content"),background:this.shadowRoot.querySelector(".ticket-background"),wrapper:this.shadowRoot.querySelector(".ticket-wrapper"),discardButton:this.shadowRoot.querySelector(".discard-history-button"),flipButton:this.shadowRoot.querySelector(".flip-history-button")}}handleButtonOverlay(t){this.flipped||("mouseover"===t.type?(this.dom.overlay.classList.add("transition-action"),this.dom.overlay.classList.remove("hidden")):"mouseout"===t.type&&this.dom.overlay.classList.add("hidden"))}flipCard(){this.animations||(this.addTransitionEffects.bind(this)(),this.animations=!0),e([this.dom.background,this.dom.backContent,this.dom.frontContent],"flipped"),this.dom.wrapper.classList.toggle("ticket-hoverable"),this.flipped=!this.flipped}addTransitionEffects(){e([this.dom.frontContent,this.dom.backContent,this.dom.background],"transition-action")}}customElements.define("historical-ticket",s);